DROP TABLE IF EXISTS "user",
    "mpa",
    "genre",
    "film",
    "film_genre",
    "like_list",
    "friend_list";


CREATE TABLE IF NOT EXISTS "user"
(
    ID       INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    EMAIL    varchar NOT NULL UNIQUE,
    LOGIN    varchar NOT NULL UNIQUE,
    NAME     varchar NOT NULL,
    BIRTHDAY date
);

CREATE TABLE IF NOT EXISTS "mpa"
(
    ID   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME varchar NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS "genre"
(
    ID   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME varchar NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS "film"
(
    ID           INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME         varchar                       NOT NULL UNIQUE,
    DESCRIPTION  varchar,
    MPA_ID       INTEGER REFERENCES "mpa" (ID) NOT NULL,
    RELEASE_DATE date,
    DURATION     INTEGER
);

CREATE TABLE IF NOT EXISTS "film_genre"
(
    FILM_ID  INTEGER REFERENCES "film" (ID)  NOT NULL,
    GENRE_ID INTEGER REFERENCES "genre" (ID) NOT NULL
);

CREATE TABLE IF NOT EXISTS "like_list"
(
    FILM_ID INTEGER REFERENCES "film" (ID) NOT NULL,
    USER_ID INTEGER REFERENCES "user" (ID) NOT NULL
);

CREATE TABLE IF NOT EXISTS "friend_list"
(
    USER_ID   INTEGER REFERENCES "user" (ID) NOT NULL,
    FRIEND_ID INTEGER REFERENCES "user" (ID) NOT NULL
);
